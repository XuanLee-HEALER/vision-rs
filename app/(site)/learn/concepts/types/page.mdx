<!-- markdownlint-disable MD046 -->

import LearnLayout from '@/components/LearnLayout';
import MermaidDiagram from '@/components/MermaidDiagram';
import MemoryLayout3D from '@/components/MemoryLayout3D';

export const metadata = {
  title: 'æ•°æ®ç±»å‹ - Vision-RS',
  description: 'Rust çš„æ ‡é‡ç±»å‹ä¸å¤åˆç±»å‹è¯¦è§£',
};

<LearnLayout>

# æ•°æ®ç±»å‹

Rust æ˜¯**é™æ€ç±»å‹**ï¼ˆstatically typedï¼‰è¯­è¨€ï¼Œç¼–è¯‘æ—¶å¿…é¡»çŸ¥é“æ‰€æœ‰å˜é‡çš„ç±»å‹ã€‚

## ç±»å‹ç³»ç»Ÿæ¦‚è§ˆ

<MermaidDiagram
  chart={`
graph TD
    A[Rust ç±»å‹ç³»ç»Ÿ] --> B[æ ‡é‡ç±»å‹<br/>Scalar Types]
    A --> C[å¤åˆç±»å‹<br/>Compound Types]

    B --> B1[æ•´æ•°<br/>Integers]
    B --> B2[æµ®ç‚¹æ•°<br/>Floats]
    B --> B3[å¸ƒå°”<br/>Boolean]
    B --> B4[å­—ç¬¦<br/>Character]

    C --> C1[å…ƒç»„<br/>Tuple]
    C --> C2[æ•°ç»„<br/>Array]

    B1 --> B1A[æœ‰ç¬¦å·: i8, i16, i32, i64, i128, isize]
    B1 --> B1B[æ— ç¬¦å·: u8, u16, u32, u64, u128, usize]

    B2 --> B2A[f32: å•ç²¾åº¦]
    B2 --> B2B[f64: åŒç²¾åº¦]

    style B fill:#8aadf4,stroke:#8aadf4,color:#24273a
    style C fill:#a6da95,stroke:#a6da95,color:#24273a

`} />

## æ ‡é‡ç±»å‹

æ ‡é‡ç±»å‹ä»£è¡¨**å•ä¸ªå€¼**ã€‚Rust æœ‰å››ç§ä¸»è¦çš„æ ‡é‡ç±»å‹ï¼š

### 1. æ•´æ•°ç±»å‹

æ•´æ•°æ˜¯æ²¡æœ‰å°æ•°éƒ¨åˆ†çš„æ•°å­—ï¼š

| é•¿åº¦    | æœ‰ç¬¦å·  | æ— ç¬¦å·  | èŒƒå›´ï¼ˆæœ‰ç¬¦å·ï¼‰   | èŒƒå›´ï¼ˆæ— ç¬¦å·ï¼‰ |
| ------- | ------- | ------- | ---------------- | -------------- |
| 8-bit   | `i8`    | `u8`    | -128 ~ 127       | 0 ~ 255        |
| 16-bit  | `i16`   | `u16`   | -32,768 ~ 32,767 | 0 ~ 65,535     |
| 32-bit  | `i32`   | `u32`   | -2Â³Â¹ ~ 2Â³Â¹-1     | 0 ~ 2Â³Â²-1      |
| 64-bit  | `i64`   | `u64`   | -2â¶Â³ ~ 2â¶Â³-1     | 0 ~ 2â¶â´-1      |
| 128-bit | `i128`  | `u128`  | -2Â¹Â²â· ~ 2Â¹Â²â·-1   | 0 ~ 2Â¹Â²â¸-1     |
| arch    | `isize` | `usize` | å–å†³äºæ¶æ„       | å–å†³äºæ¶æ„     |

````rust
fn main() {
    let a: i32 = -42;         // æœ‰ç¬¦å· 32 ä½
    let b: u32 = 42;          // æ— ç¬¦å· 32 ä½
    let c = 98_222;           // é»˜è®¤ i32
    let d: isize = 100;       // å¹³å°ç›¸å…³ï¼ˆ64ä½ç³»ç»Ÿ = i64ï¼‰

    // æ•´æ•°å­—é¢é‡
    let decimal = 98_222;      // åè¿›åˆ¶
    let hex = 0xff;            // åå…­è¿›åˆ¶
    let octal = 0o77;          // å…«è¿›åˆ¶
    let binary = 0b1111_0000;  // äºŒè¿›åˆ¶
    let byte = b'A';           // å­—èŠ‚ï¼ˆä»…é™ u8ï¼‰
}
```text

**æ•´æ•°æº¢å‡º**ï¼š

```rust
fn main() {
    let mut x: u8 = 255;
    // x = x + 1;  // Debug æ¨¡å¼ï¼španic!
                   // Release æ¨¡å¼ï¼šæº¢å‡ºå›ç»•ï¼ˆwrap aroundï¼‰ä¸º 0

    // æ˜¾å¼å¤„ç†æº¢å‡º
    let y = x.wrapping_add(1);      // 256 â†’ 0
    let z = x.checked_add(1);       // è¿”å› Option<u8>: None
    let w = x.saturating_add(1);    // é¥±å’Œä¸º 255
    let o = x.overflowing_add(1);   // è¿”å› (å€¼, æ˜¯å¦æº¢å‡º)
}
```text

### 2. æµ®ç‚¹ç±»å‹

Rust æœ‰ä¸¤ç§æµ®ç‚¹ç±»å‹ï¼š`f32`ï¼ˆå•ç²¾åº¦ï¼‰å’Œ `f64`ï¼ˆåŒç²¾åº¦ï¼Œ**é»˜è®¤**ï¼‰ï¼š

```rust
fn main() {
    let x = 2.0;        // f64ï¼ˆé»˜è®¤ï¼‰
    let y: f32 = 3.0;   // f32

    // æµ®ç‚¹è¿ç®—
    let sum = 5.0 + 10.0;
    let difference = 95.5 - 4.3;
    let product = 4.0 * 30.0;
    let quotient = 56.7 / 32.2;

    // ç‰¹æ®Šå€¼
    let inf = f64::INFINITY;
    let neg_inf = f64::NEG_INFINITY;
    let nan = f64::NAN;

    println!("NaN == NaN? {}", nan == nan);  // false!
}
```text

âš ï¸ **æ³¨æ„**ï¼šæµ®ç‚¹æ•°éµå¾ª IEEE-754 æ ‡å‡†ï¼Œå¯èƒ½æœ‰ç²¾åº¦é—®é¢˜ã€‚

### 3. å¸ƒå°”ç±»å‹

å¸ƒå°”ç±»å‹åªæœ‰ä¸¤ä¸ªå€¼ï¼š`true` å’Œ `false`ï¼Œå ç”¨ 1 å­—èŠ‚ï¼š

```rust
fn main() {
    let t = true;
    let f: bool = false;

    // å¸¸ç”¨äºæ¡ä»¶è¯­å¥
    if t {
        println!("è¿™æ˜¯çœŸçš„ï¼");
    }

    // å¸ƒå°”è¿ç®—
    let and = true && false;   // false
    let or = true || false;    // true
    let not = !true;           // false
}
```text

### 4. å­—ç¬¦ç±»å‹

`char` ç±»å‹ä»£è¡¨ä¸€ä¸ª Unicode æ ‡é‡å€¼ï¼Œå ç”¨ **4 å­—èŠ‚**ï¼š

```rust
fn main() {
    let c = 'z';
    let z: char = 'â„¤';
    let heart_eyed_cat = 'ğŸ˜»';
    let chinese = 'ä¸­';

    println!("Size of char: {} bytes", std::mem::size_of::<char>());  // 4

    // char æ˜¯ Unicode æ ‡é‡å€¼
    let emoji = 'ğŸ¦€';  // Rust çš„å‰ç¥¥ç‰© Ferrisï¼
}
```text

**char vs å­—ç¬¦ä¸²**ï¼š

```rust
fn main() {
    let c: char = 'A';          // å•ä¸ª Unicode å­—ç¬¦ï¼Œ4 å­—èŠ‚
    let s: &str = "A";          // å­—ç¬¦ä¸²åˆ‡ç‰‡ï¼Œ1 å­—èŠ‚ï¼ˆUTF-8 ç¼–ç ï¼‰

    // char å¯ä»¥åŒ…å«ä»»ä½• Unicode
    let rustacean = 'ğŸ¦€';       // âœ… åˆæ³•
    // let invalid = 'ğŸ¦€ğŸ˜»';    // âŒ ç¼–è¯‘é”™è¯¯ï¼šchar åªèƒ½æ˜¯å•ä¸ªå­—ç¬¦
}
```text

## å¤åˆç±»å‹

å¤åˆç±»å‹å¯ä»¥å°†å¤šä¸ªå€¼ç»„åˆæˆä¸€ä¸ªç±»å‹ã€‚

### 1. å…ƒç»„ï¼ˆTupleï¼‰

å…ƒç»„å¯ä»¥ç»„åˆ**ä¸åŒç±»å‹**çš„å€¼ï¼š

```rust
fn main() {
    let tup: (i32, f64, u8) = (500, 6.4, 1);

    // è§£æ„ï¼ˆdestructuringï¼‰
    let (x, y, z) = tup;
    println!("y çš„å€¼: {}", y);  // 6.4

    // é€šè¿‡ç´¢å¼•è®¿é—®
    let five_hundred = tup.0;
    let six_point_four = tup.1;
    let one = tup.2;

    // å•å…ƒç±»å‹ï¼ˆunit typeï¼‰
    let unit = ();  // ç©ºå…ƒç»„ï¼Œå¤§å°ä¸º 0 å­—èŠ‚
}
```text

**å…ƒç»„çš„å†…å­˜å¸ƒå±€**ï¼š

```rust
fn main() {
    let tuple: (u8, u16, u8) = (1, 2, 3);
    println!("Size: {} bytes", std::mem::size_of_val(&tuple));  // 6 bytesï¼ˆå¯èƒ½æœ‰å¡«å……ï¼‰
}
```text

<MemoryLayout3D scenario="stack" />

### 2. æ•°ç»„ï¼ˆArrayï¼‰

æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ å¿…é¡»æ˜¯**ç›¸åŒç±»å‹**ï¼Œä¸”**é•¿åº¦å›ºå®š**ï¼š

```rust
fn main() {
    // æ•°ç»„å£°æ˜
    let a = [1, 2, 3, 4, 5];
    let b: [i32; 5] = [1, 2, 3, 4, 5];  // ç±»å‹æ ‡æ³¨ï¼š[ç±»å‹; é•¿åº¦]

    // åˆå§‹åŒ–ç›¸åŒå€¼
    let c = [3; 5];  // [3, 3, 3, 3, 3]

    // è®¿é—®å…ƒç´ 
    let first = a[0];
    let second = a[1];

    // æ•°ç»„æ˜¯æ ˆåˆ†é…çš„
    println!("æ•°ç»„å¤§å°: {} bytes", std::mem::size_of_val(&a));  // 20 bytes (5 * 4)
}
```text

**æ•°ç»„ vs Vec**ï¼š

```rust
fn main() {
    // æ•°ç»„ï¼šå›ºå®šé•¿åº¦ï¼Œæ ˆåˆ†é…
    let arr = [1, 2, 3, 4, 5];
    // arr.push(6);  // âŒ ç¼–è¯‘é”™è¯¯ï¼šæ•°ç»„ä¸èƒ½æ”¹å˜é•¿åº¦

    // Vecï¼šåŠ¨æ€é•¿åº¦ï¼Œå †åˆ†é…
    let mut vec = vec![1, 2, 3, 4, 5];
    vec.push(6);  // âœ… å¯ä»¥å¢é•¿
}
```text

**è¶Šç•Œè®¿é—®**ï¼š

```rust
fn main() {
    let a = [1, 2, 3, 4, 5];

    // let index = 10;
    // let element = a[index];  // âš ï¸ è¿è¡Œæ—¶ panic!ï¼ˆè€Œéç¼–è¯‘é”™è¯¯ï¼‰
    //                           // thread 'main' panicked at 'index out of bounds'

    // å®‰å…¨è®¿é—®
    match a.get(10) {
        Some(value) => println!("å€¼: {}", value),
        None => println!("ç´¢å¼•è¶Šç•Œ"),
    }
}
```text

## åˆ‡ç‰‡ç±»å‹

åˆ‡ç‰‡ï¼ˆsliceï¼‰æ˜¯å¯¹è¿ç»­åºåˆ—çš„å¼•ç”¨ï¼Œ**æ²¡æœ‰æ‰€æœ‰æƒ**ï¼š

```rust
fn main() {
    let a = [1, 2, 3, 4, 5];

    // åˆ‡ç‰‡
    let slice: &[i32] = &a[1..3];  // [2, 3]

    println!("åˆ‡ç‰‡: {:?}", slice);

    // å­—ç¬¦ä¸²åˆ‡ç‰‡
    let s = String::from("hello world");
    let hello: &str = &s[0..5];    // "hello"
    let world: &str = &s[6..11];   // "world"
}
```text

## ç±»å‹è½¬æ¢

Rust **ä¸ä¼š**éšå¼è½¬æ¢æ•°å€¼ç±»å‹ï¼š

```rust
fn main() {
    let x: i32 = 10;
    // let y: i64 = x;  // âŒ ç¼–è¯‘é”™è¯¯ï¼šç±»å‹ä¸åŒ¹é…

    // å¿…é¡»æ˜¾å¼è½¬æ¢
    let y: i64 = x as i64;  // âœ… ä½¿ç”¨ as å…³é”®å­—

    // è½¬æ¢å¯èƒ½æˆªæ–­
    let a: i32 = 1000;
    let b: u8 = a as u8;  // 232ï¼ˆæº¢å‡ºï¼Œå–ä½ 8 ä½ï¼‰

    println!("b = {}", b);
}
```text

**å®‰å…¨è½¬æ¢**ï¼š

```rust
fn main() {
    let x: i32 = 1000;

    // ä½¿ç”¨ try_intoï¼ˆéœ€è¦ use std::convert::TryIntoï¼‰
    use std::convert::TryInto;

    let y: Result<u8, _> = x.try_into();
    match y {
        Ok(val) => println!("è½¬æ¢æˆåŠŸ: {}", val),
        Err(_) => println!("è½¬æ¢å¤±è´¥ï¼šå€¼è¶…å‡ºèŒƒå›´"),
    }
}
```text

## ç±»å‹åˆ«å

ä½¿ç”¨ `type` å…³é”®å­—åˆ›å»ºç±»å‹åˆ«åï¼š

```rust
type Kilometers = i32;

fn main() {
    let distance: Kilometers = 100;
    let another: i32 = 50;

    // Kilometers å’Œ i32 å®Œå…¨ç›¸åŒ
    let total = distance + another;  // âœ… å¯ä»¥ç›¸åŠ 
}
```text

## ç±»å‹æ¨å¯¼

Rust çš„ç±»å‹æ¨å¯¼éå¸¸å¼ºå¤§ï¼š

```rust
fn main() {
    // ä»ä½¿ç”¨æ–¹å¼æ¨å¯¼
    let mut v = Vec::new();  // ç±»å‹æœªçŸ¥

    v.push(1);  // ç°åœ¨ç¼–è¯‘å™¨çŸ¥é“ v æ˜¯ Vec<i32>

    // ä»è¿”å›ç±»å‹æ¨å¯¼
    let x = "42".parse().expect("Not a number!");  // âŒ ç¼–è¯‘é”™è¯¯ï¼šç±»å‹ä¸æ˜ç¡®

    let x: i32 = "42".parse().expect("Not a number!");  // âœ… æ˜ç¡®ç±»å‹
}
```text

## å†…å­˜å¤§å°

æŸ¥çœ‹ç±»å‹çš„å†…å­˜å¤§å°ï¼š

```rust
use std::mem;

fn main() {
    println!("i32: {} bytes", mem::size_of::<i32>());    // 4
    println!("f64: {} bytes", mem::size_of::<f64>());    // 8
    println!("bool: {} bytes", mem::size_of::<bool>());  // 1
    println!("char: {} bytes", mem::size_of::<char>());  // 4

    println!("(i32, f64, u8): {} bytes",
        mem::size_of::<(i32, f64, u8)>());  // 16ï¼ˆæœ‰å¯¹é½å¡«å……ï¼‰

    println!("[i32; 10]: {} bytes",
        mem::size_of::<[i32; 10]>());  // 40
}
```text

## å®è·µå»ºè®®

### âœ… æ¨èåšæ³•

```rust
fn main() {
    // 1. ä½¿ç”¨ç±»å‹æ¨å¯¼ï¼ˆé™¤éæœ‰æ­§ä¹‰ï¼‰
    let count = 42;  // æ¸…æ™°ï¼Œæ¨å¯¼ä¸º i32

    // 2. åœ¨éœ€è¦æ—¶æ ‡æ³¨ç±»å‹
    let parsed: i64 = "100".parse().unwrap();

    // 3. ä½¿ç”¨ usize/isize ä½œä¸ºç´¢å¼•å’Œå¤§å°
    let arr = [1, 2, 3];
    for i in 0..arr.len() {  // len() è¿”å› usize
        println!("{}", arr[i]);
    }

    // 4. ä¼˜å…ˆä½¿ç”¨ f64 è€Œä¸æ˜¯ f32
    let pi = 3.14159;  // é»˜è®¤ f64ï¼Œç²¾åº¦æ›´é«˜
}
```text

### âŒ é¿å…åšæ³•

```rust
fn main() {
    // âŒ è¿‡åº¦æ ‡æ³¨ç±»å‹ï¼ˆç±»å‹æ¨å¯¼å·²è¶³å¤Ÿï¼‰
    let x: i32 = 5;
    let y: i32 = 10;
    let sum: i32 = x + y;

    // âŒ ä¸å¿…è¦çš„ç±»å‹è½¬æ¢
    let a: i32 = 10;
    let b: i32 = a as i32;  // å¤šä½™

    // âŒ æ··ç”¨ä¸åŒæ•´æ•°ç±»å‹
    let x: i32 = 10;
    let y: i64 = 20;
    // let z = x + y;  // âŒ éœ€è¦æ˜¾å¼è½¬æ¢
}
```text

## ç»ƒä¹ é¢˜

### ç»ƒä¹  1ï¼šè®¡ç®—å†…å­˜å ç”¨

```rust
fn main() {
    let data = (42u8, 3.14f64, 'A', [1i32, 2, 3]);
    // é—®ï¼šdata å ç”¨å¤šå°‘å­—èŠ‚ï¼Ÿ
}
```text

<details>
<summary>æŸ¥çœ‹ç­”æ¡ˆ</summary>

```rust
use std::mem;

fn main() {
    let data = (42u8, 3.14f64, 'A', [1i32, 2, 3]);
    println!("{} bytes", mem::size_of_val(&data));  // 32 bytes
    // u8(1) + padding(7) + f64(8) + char(4) + [i32;3](12) = 32
}
```text

</details>

### ç»ƒä¹  2ï¼šç±»å‹è½¬æ¢

ä¿®å¤ä»¥ä¸‹ä»£ç ï¼š

```rust
fn main() {
    let x: u8 = 255;
    let y: u16 = x;
    println!("{}", y);
}
```text

<details>
<summary>æŸ¥çœ‹ç­”æ¡ˆ</summary>

```rust
fn main() {
    let x: u8 = 255;
    let y: u16 = x as u16;  // æ˜¾å¼è½¬æ¢
    println!("{}", y);  // 255
}
```text

</details>

## å°ç»“

- âœ… Rust æ˜¯**é™æ€ç±»å‹**è¯­è¨€ï¼Œç¼–è¯‘æ—¶ç¡®å®šç±»å‹
- âœ… **æ ‡é‡ç±»å‹**ï¼šæ•´æ•°ã€æµ®ç‚¹æ•°ã€å¸ƒå°”ã€å­—ç¬¦
- âœ… **å¤åˆç±»å‹**ï¼šå…ƒç»„ã€æ•°ç»„
- âœ… æ•´æ•°é»˜è®¤ `i32`ï¼Œæµ®ç‚¹æ•°é»˜è®¤ `f64`
- âœ… `char` æ˜¯ **4 å­—èŠ‚**çš„ Unicode æ ‡é‡å€¼
- âœ… æ•°ç»„é•¿åº¦**å›ºå®š**ï¼Œæ ˆåˆ†é…ï¼›Vec é•¿åº¦**åŠ¨æ€**ï¼Œå †åˆ†é…
- âœ… **ä¸ä¼š**éšå¼ç±»å‹è½¬æ¢ï¼Œä½¿ç”¨ `as` æ˜¾å¼è½¬æ¢
- âœ… ä½¿ç”¨ `std::mem::size_of` æŸ¥çœ‹ç±»å‹å¤§å°

ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬å°†æ·±å…¥å­¦ä¹  Rust çš„**æ‰€æœ‰æƒç³»ç»Ÿ**ã€‚

</LearnLayout>

export default ({ children }) => <>{children}</>;
````
